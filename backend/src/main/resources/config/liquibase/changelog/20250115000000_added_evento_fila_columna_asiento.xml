<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="20250115000000-1" author="assistant">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="evento" columnName="filas_asientos"/>
            </not>
        </preConditions>
        <comment>Agregar columna filas_asientos a la tabla evento si no existe</comment>
        <addColumn tableName="evento">
            <column name="filas_asientos" type="integer" remarks="Número de filas de asientos del evento">
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="20250115000000-2" author="assistant">
        <preConditions onFail="MARK_RAN">
            <and>
                <columnExists tableName="evento" columnName="columna_asiento"/>
                <not>
                    <columnExists tableName="evento" columnName="columnas_asientos"/>
                </not>
            </and>
        </preConditions>
        <comment>Renombrar columna columna_asiento a columnas_asientos si existe la columna antigua</comment>
        <renameColumn tableName="evento" oldColumnName="columna_asiento" newColumnName="columnas_asientos" columnDataType="integer"/>
    </changeSet>

    <changeSet id="20250115000000-3" author="assistant">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <columnExists tableName="evento" columnName="columnas_asientos"/>
                </not>
                <not>
                    <columnExists tableName="evento" columnName="columna_asiento"/>
                </not>
            </and>
        </preConditions>
        <comment>Agregar columna columnas_asientos si no existe ninguna de las dos versiones</comment>
        <addColumn tableName="evento">
            <column name="columnas_asientos" type="integer" remarks="Número de columnas de asientos del evento">
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>

</databaseChangeLog>

